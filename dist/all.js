var possibleColors=["#247BA0","#70C1B3","#F3FFBD","#FF1654"],letters=letters={A:[[,1],[1,,1],[1,,1],[1,1,1],[1,,1]],B:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1],[1],[1]],G:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],L:[[1],[1],[1],[1],[1,1,1]],M:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],O:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],P:[[1,1,1],[1,,1],[1,1,1],[1],[1]],R:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],S:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],T:[[1,1,1],
    [,1],[,1],[,1],[,1]],V:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,1],[,1],[,1],[,1],[,1]],2:[[1,1,1],[,,1],[1,1,1],[1,,],[1,1,1]],3:[[1,1,1],[,,1],[,1,1],[,,1],[1,1,1]],4:[[1,,1,0],[1,,1],[1,1,1,1],[,,1],[,,1]],5:[[1,1,1,0],[1,,,],[1,1,1],[,,1],[1,1,1]],6:[[1,1,1,0],[1,,,],[1,1,1],[1,,1],[1,1,1]],7:[[1,1,1],[,,1],[,,1],[,,1],[,,1]],8:[[1,1,1],[1,,1],[1,1,1],[1,,1],[1,1,1]],9:[[1,1,1],[1,,1],[1,1,1],[,,1],[1,1,1]]};
function drawText(a,c,b,g,d){var k=[];a=a.toString();for(var h=0;h<a.length;h++){var l=letters[a.charAt(h)];l&&k.push(l)}ctx.fillStyle=possibleColors[1];d=d||gameCanvas.width/32;b=b||(gameCanvas.width-d*a.length*4)/2;"PLAY"===a&&(objectFactory.currentBtn={startX:b,startY:g||gameCanvas.height/4+c*d*4+40*c});for(h=0;h<k.length;h++){for(var l=k[h],q=g||gameCanvas.height/4+c*d*4+40*c,r=0,m=0;m<l.length;m++){for(var w=l[m],x=0;x<w.length;x++)w[x]&&ctx.fillRect(b+x*d,q,d,d);r=Math.max(r,w.length*d);q+=
    d}b+=d+r}"PLAY"===a&&(objectFactory.currentBtn.endX=b,objectFactory.currentBtn.endY=q)}var GameState={GAME_OVER:"gameOver",PLAYING:"playing"};
function ExplodedBall(a,c,b,g){this.x=a;this.y=c;this.r=b;this.color=g;this.direction=1<2*Math.random()?1:-1;this.vx=~~(10*Math.random())*this.direction;this.vy=~~(15*Math.random());this.draw=function(a){a.beginPath();a.arc(this.x,this.y,this.r,0,2*Math.PI,!1);a.fillStyle=this.color;a.fill();a.closePath()};this.update=function(){this.x+=this.vx;this.y+=this.vy;this.vx*=.99;this.vy*=.99;this.vy+=.25}}
function H(){this.A=function(a){for(var c=0;24>c;c++)this[String.fromCharCode(97+c)]=a[c]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
var U=new function(){this.z=new H;var a,c,b,g,d,k,h,l,q,r,m,w;this.reset=function(){var a=this.z;g=100/(a.f*a.f+.001);d=100/(a.g*a.g+.001);k=1-.01*a.h*a.h*a.h;h=1E-6*-a.i*a.i*a.i;a.a||(m=.5-a.n/2,w=5E-5*-a.o);l=1+a.l*a.l*(0<a.l?-.9:10);q=0;r=1==a.m?0:2E4*(1-a.m)*(1-a.m)+32};this.C=function(){this.reset();var d=this.z;a=1E5*d.b*d.b;c=1E5*d.c*d.c;b=1E5*d.e*d.e+12;return 3*((a+c+b)/3|0)};this.B=function(x,M){var e=this.z,N=1!=e.s||e.v,y=.1*e.v*e.v,O=1+3E-4*e.w,t=.1*e.s*e.s*e.s,Y=1+1E-4*e.t,Z=1!=e.s,
    aa=e.x*e.x,ba=e.g,P=e.q||e.r,ca=.2*e.r*e.r*e.r,Q=e.q*e.q*(0>e.q?-1020:1020),R=e.p?(2E4*(1-e.p)*(1-e.p)|0)+32:0,da=e.d,S=e.j/2,ea=.01*e.k*e.k,I=e.a,J=a,fa=1/a,ga=1/c,ha=1/b,e=5/(1+20*e.u*e.u)*(.01+t);.8<e&&(e=.8);for(var e=1-e,K=!1,T=0,A=0,B=0,V=0,F=0,C,D=0,n,u=0,v,L=0,f,W=0,z,X=0,G=Array(1024),E=Array(32),p=G.length;p--;)G[p]=0;for(p=E.length;p--;)E[p]=2*Math.random()-1;for(p=0;p<M;p++){if(K)return p;R&&++W>=R&&(W=0,this.reset());r&&++q>=r&&(r=0,g*=l);k+=h;g*=k;g>d&&(g=d,0<ba&&(K=!0));n=g;0<S&&(X+=
    ea,n*=1+Math.sin(X)*S);n|=0;8>n&&(n=8);I||(m+=w,0>m?m=0:.5<m&&(m=.5));if(++A>J)switch(A=0,++T){case 1:J=c;break;case 2:J=b}switch(T){case 0:B=A*fa;break;case 1:B=1+2*(1-A*ga)*da;break;case 2:B=1-A*ha;break;case 3:B=0,K=!0}P&&(Q+=ca,v=Q|0,0>v?v=-v:1023<v&&(v=1023));N&&O&&(y*=O,1E-5>y?y=1E-5:.1<y&&(y=.1));z=0;for(var ia=8;ia--;){u++;if(u>=n&&(u%=n,3==I))for(C=E.length;C--;)E[C]=2*Math.random()-1;switch(I){case 0:f=u/n<m?.5:-.5;break;case 1:f=1-u/n*2;break;case 2:f=u/n;f=6.28318531*(.5<f?f-1:f);f=1.27323954*
    f+.405284735*f*f*(0>f?1:-1);f=.225*((0>f?-1:1)*f*f-f)+f;break;case 3:f=E[Math.abs(32*u/n|0)]}N&&(C=D,t*=Y,0>t?t=0:.1<t&&(t=.1),Z?(F+=(f-D)*t,F*=e):(D=f,F=0),D+=F,V+=D-C,f=V*=1-y);P&&(G[L%1024]=f,f+=G[(L-v+1024)%1024],L++);z+=f}z*=.125*B*aa;x[p]=1<=z?32767:-1>=z?-32768:32767*z|0}return M}};
window.jsfxr=function(a){U.z.A(a);var c=U.C();a=new Uint8Array(4*((c+1)/2|0)+44);var c=2*U.B(new Uint16Array(a.buffer,44),c),b=new Uint32Array(a.buffer,0,44);b[0]=1179011410;b[1]=c+36;b[2]=1163280727;b[3]=544501094;b[4]=16;b[5]=65537;b[6]=44100;b[7]=88200;b[8]=1048578;b[9]=1635017060;b[10]=c;for(var c=c+44,b=0,g="data:audio/wav;base64,";b<c;b+=3)var d=a[b]<<16|a[b+1]<<8|a[b+2],g=g+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>
    12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d&63]);return g};var scoreUpSound=jsfxr([3,,.0492,.3652,.3894,.8659,,,,,,.2355,.5761,,,,,,1,,,,,.5]),explosionSound=jsfxr([3,,.3708,.5822,.3851,.0584,,-.0268,,,,-.0749,.7624,,,,,,1,,,,,.5]),ballJumpSound=jsfxr([2,,.2157,,.05,.4632,,.1288,,,,,,.4423,,,,,.4543,,,,,.5]);function playSound(a){var c=new Audio;c.src=a;c.play()}
function playScoreUp(){playSound(scoreUpSound)}function playExplosion(){playSound(explosionSound)}function playBallJump(){playSound(ballJumpSound)}function updateScore(){playScoreUp();objectFactory.score+=1}function resetScore(){objectFactory.score=0}
function detectCollision(){var a=objectFactory.ball;if(a)for(var c=0;c<objectFactory.rings.length;c++){var b=objectFactory.rings[c];!b.isScoreMarked&&a.y<b.y-b.r-b.lineWidth/2-a.r&&(b.isScoreMarked=!0,objectFactory.ball.changeColor());if(a.y>=b.y-b.r-b.lineWidth/2-a.r&&a.y<=b.y-b.r+b.lineWidth/2+a.r)for(var g=Math.atan(a.r/b.r),d=0;d<possibleColors.length;d++){var k=b.startAngle+b.currentAngle+Math.PI/2*d,h=b.endAngle+b.currentAngle+Math.PI/2*d,k=k>2*Math.PI?k-2*Math.PI:k,h=h>2*Math.PI?h-2*Math.PI:
    h;k<=1.5*Math.PI-g&&h>=1.5*Math.PI+g&&possibleColors[d]!==a.color&&a.explode()}if(a.y<=b.y+b.r+b.lineWidth/2+a.r&&a.y>=b.y+b.r-b.lineWidth/2-a.r)for(g=Math.atan(a.r/b.r),d=0;d<possibleColors.length;d++)k=b.startAngle+b.currentAngle+Math.PI/2*d,h=b.endAngle+b.currentAngle+Math.PI/2*d,k=k>2*Math.PI?k-2*Math.PI:k,h=h>2*Math.PI?h-2*Math.PI:h,k<=.5*Math.PI-g&&h>=.5*Math.PI+g&&possibleColors[d]!==a.color&&a.explode()}}var keysDown={};
function clickEventHandler(){objectFactory.cursor.x>=objectFactory.currentBtn.startX&&objectFactory.cursor.x<=objectFactory.currentBtn.endX&&objectFactory.cursor.y>=objectFactory.currentBtn.startY&&objectFactory.cursor.y<=objectFactory.currentBtn.endY&&(objectFactory.rings=[],objectFactory.ball=new Ball(gameCanvas.width/2,gameCanvas.height-100),resetScore(),objectFactory.gameState="playing",bindGamePlayingEvents())}
function mouseMoveHandler(a){objectFactory.cursor.x=a.pageX-gameCanvas.offsetLeft;objectFactory.cursor.y=a.pageY-gameCanvas.offsetTop}function bindNotStartedGameEvents(){addEventListener("mousemove",mouseMoveHandler);addEventListener("click",clickEventHandler)}function onJumpBall(a){playBallJump();"touchstart"===a.type&&(a.keyCode=32);keysDown[a.keyCode]=!0}function onGravitizeBall(a){"touchend"===a.type&&(a.keyCode=32);keysDown[a.keyCode]=!1}
function bindGamePlayingEvents(){removeEventListener("mousemove",mouseMoveHandler);removeEventListener("click",clickEventHandler);addEventListener("keydown",onJumpBall);addEventListener("keyup",onGravitizeBall);addEventListener("touchstart",onJumpBall);addEventListener("touchend",onGravitizeBall)}
function bindGameOverEvents(){removeEventListener("keyup",onJumpBall);removeEventListener("keyup",onGravitizeBall);removeEventListener("touchstart",onJumpBall);removeEventListener("touchend",onGravitizeBall)}addEventListener("resize",function(){gameCanvas.height=window.innerHeight;gameCanvas.width=2*gameCanvas.height/3});var objectFactory={rings:[],gameState:"notStarted",cursor:{},ball:{}};
function Ball(a,c){this.x=a;this.y=c;this.r=10;this.vy=5;this.gravity=2.5;this.lineWidth=10;this.remove=!1;this.generateColor=function(){return possibleColors[Math.floor(Math.random()*possibleColors.length)]};this.color=this.generateColor();this.draw=function(a){a.beginPath();a.arc(this.x,this.y,this.r,0,2*Math.PI,!1);a.fillStyle=this.color;a.fill();a.closePath()};this.onKeyPress=function(){keysDown[32]?(repositionRings(),this.y-=this.vy):this.y<gameCanvas.height-100&&(this.y+=this.gravity)};this.getNewBallColor=
    function(){var a=this.generateColor();a!=this.color?this.color=a:this.getNewBallColor()};this.changeColor=function(){updateScore();this.getNewBallColor()};this.explode=function(){objectFactory.gameState="gameOver";bindGameOverEvents();explodeBall();playExplosion();resetScore()}}
function Ring(a,c,b){this.x=a;this.y=c;this.r=b;this.startAngle=0;this.endAngle=.5*Math.PI;this.lineWidth=10;this.currentAngle=0;this.isScoreMarked=!1;this.draw=function(a,b){for(var c=this.startAngle+this.currentAngle,h=this.endAngle+this.currentAngle,l=0,q=possibleColors.length;l<q;l++)a.beginPath(),a.arc(this.x,this.y,this.r,c+Math.PI/2*l,h+Math.PI/2*l,!1),a.strokeStyle=possibleColors[l],a.lineWidth=this.lineWidth,a.stroke();this.currentAngle+=b;this.currentAngle%=2*Math.PI}}
function repositionRings(){if(objectFactory.ball.y<gameCanvas.height/2+100)for(var a=0;a<objectFactory.rings.length;a++)objectFactory.rings[a].y+=5}function appendMoreRings(){if(3>objectFactory.visibleBalls)for(var a=objectFactory.visibleBalls;3>a;a++){var c=Math.floor(70*Math.random())+50;objectFactory.rings.push(new Ring(gameCanvas.width/2,objectFactory.rings[objectFactory.rings.length-1].y-c-210,c))}}
function drawRings(a,c){if(objectFactory.ball){for(var b=objectFactory.visibleBalls=0;b<objectFactory.rings.length;b++)objectFactory.rings[b].draw(a,c),objectFactory.rings[b].y<=objectFactory.ball.y&&objectFactory.visibleBalls++;appendMoreRings()}}
function generateRings(a,c){objectFactory.rings.length||(objectFactory.rings.push(new Ring(a.width/2,a.height/2,Math.floor(70*Math.random())+50)),objectFactory.rings.push(new Ring(a.width/2,a.height/2-300,Math.floor(70*Math.random())+50)));drawRings(ctx,c)}
function explodeBall(){objectFactory.explodedBalls=[];for(var a=0;50>a;a++)objectFactory.explodedBalls.push(new ExplodedBall(objectFactory.ball.x,objectFactory.ball.y,objectFactory.ball.r/2,possibleColors[Math.floor(Math.random()*possibleColors.length)]));objectFactory.ball.remove=!0}function notStartedGameState(){drawText("FLAPPY",0);drawText("BALL",1);drawText("PLAY",3)}
function playingGameState(a){drawText(objectFactory.score,0,20,20,10);objectFactory.ball.draw(ctx);objectFactory.ball.onKeyPress(ctx);generateRings(gameCanvas,a);detectCollision()}
function gameOverState(){objectFactory.ball={};objectFactory.rings=[];if(objectFactory.explodedBalls&&objectFactory.explodedBalls.length)for(var a=0;a<objectFactory.explodedBalls.length;a++)objectFactory.explodedBalls[a].draw(gameCanvas.getContext("2d")),objectFactory.explodedBalls[a].update();drawText("GAME",0);drawText("OVER",1);drawText("RESTART",3)}
function gameStateHandler(a){ctx.clearRect(0,0,gameCanvas.width,gameCanvas.height);switch(objectFactory.gameState){case "notStarted":notStartedGameState();break;case "playing":playingGameState(a);break;case "gameOver":gameOverState()}}
(function(){var a,c=window,b=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.msRequestAnimationFrame||c.mozRequestAnimationFrame,c=window.gameCanvas=document.createElement("canvas");window.ctx=c.getContext("2d");c.height=window.innerHeight;c.width=2*c.height/3;document.body.appendChild(c);var g=function(){var c=Date.now();gameStateHandler((c-a)/1E3);a=c;b(g)};a=Date.now();g();bindNotStartedGameEvents()})();